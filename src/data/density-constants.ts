import { DIPPRDensityProps } from '../interfaces/utils';

export const DIPPRDensityDictionary: Record<string, DIPPRDensityProps> = {
  Acetaldehyde: {
    name: 'Acetaldehyde',
    formula: 'C2H4O',
    CAS: '75-07-0',
    molecularWeight: 44.05256,
    C1: 1.711365,
    C2: 0.26355,
    C3: 466,
    C4: 0.28571,
    minimumTemperature: 149.78,
    maximumTemperature: 466,
    densityAtMinimumTemperature: 21.423,
    densityAtMaximumTemperature: 6.4935,
  },
  //<----Batch1
  Acetamide: {
    name: 'Acetamide',
    formula: 'C2H5NO',
    CAS: '60-35-5',
    molecularWeight: 59.0672,
    C1: 1.016,
    C2: 0.21845,
    C3: 761,
    C4: 0.26116,
    minimumTemperature: 353.33,
    maximumTemperature: 761.0,
    densityAtMinimumTemperature: 16.936,
    densityAtMaximumTemperature: 4.6509,
  },

  AceticAcid: {
    name: 'Acetic acid',
    formula: 'C2H4O2',
    CAS: '64-19-7',
    molecularWeight: 60.052,
    C1: 1.4486,
    C2: 0.25892,
    C3: 591.95,
    C4: 0.2529,
    minimumTemperature: 289.81,
    maximumTemperature: 591.95,
    densityAtMinimumTemperature: 17.492,
    densityAtMaximumTemperature: 5.5948,
  },

  AceticAnhydride: {
    name: 'Acetic anhydride',
    formula: 'C4H6O3',
    CAS: '108-24-7',
    molecularWeight: 102.08864,
    C1: 0.79388,
    C2: 0.24119,
    C3: 606,
    C4: 0.29817,
    minimumTemperature: 200.15,
    maximumTemperature: 606.0,
    densityAtMinimumTemperature: 11.626,
    densityAtMaximumTemperature: 3.2915,
  },

  Acetone: {
    name: 'Acetone',
    formula: 'C3H6O',
    CAS: '67-64-1',
    molecularWeight: 58.07914,
    C1: 1.2332,
    C2: 0.25886,
    C3: 508.2,
    C4: 0.2913,
    minimumTemperature: 178.45,
    maximumTemperature: 508.2,
    densityAtMinimumTemperature: 15.683,
    densityAtMaximumTemperature: 4.764,
  },

  Acetonitrile: {
    name: 'Acetonitrile',
    formula: 'C2H3N',
    CAS: '75-05-8',
    molecularWeight: 41.0519,
    C1: 1.0693,
    C2: 0.20656,
    C3: 545.5,
    C4: 0.24699,
    minimumTemperature: 229.32,
    maximumTemperature: 545.5,
    densityAtMinimumTemperature: 20.544,
    densityAtMaximumTemperature: 5.1767,
  },

  Acetylene: {
    name: 'Acetylene',
    formula: 'C2H2',
    CAS: '74-86-2',
    molecularWeight: 26.03728,
    C1: 2.4507,
    C2: 0.27448,
    C3: 308.3,
    C4: 0.28752,
    minimumTemperature: 192.4,
    maximumTemperature: 308.3,
    densityAtMinimumTemperature: 23.692,
    densityAtMaximumTemperature: 8.9285,
  },

  Acrolein: {
    name: 'Acrolein',
    formula: 'C3H4O',
    CAS: '107-02-8',
    molecularWeight: 56.06326,
    C1: 1.3261,
    C2: 0.26124,
    C3: 506,
    C4: 0.2489,
    minimumTemperature: 185.45,
    maximumTemperature: 506.0,
    densityAtMinimumTemperature: 16.822,
    densityAtMaximumTemperature: 5.0762,
  },

  AcrylicAcid: {
    name: 'Acrylic acid',
    formula: 'C3H4O2',
    CAS: '79-10-7',
    molecularWeight: 72.06266,
    C1: 1.2414,
    C2: 0.25822,
    C3: 615,
    C4: 0.30701,
    minimumTemperature: 286.15,
    maximumTemperature: 615,
    densityAtMinimumTemperature: 14.693,
    densityAtMaximumTemperature: 4.8075,
  },

  Acrylonitrile: {
    name: 'Acrylonitrile',
    formula: 'C3H3N',
    CAS: '107-13-1',
    molecularWeight: 53.0626,
    C1: 1.0379,
    C2: 0.22465,
    C3: 540,
    C4: 0.28921,
    minimumTemperature: 189.63,
    maximumTemperature: 540,
    densityAtMinimumTemperature: 17.254,
    densityAtMaximumTemperature: 4.6201,
  },

  Air: {
    name: 'Air',
    formula: 'Mixture',
    CAS: '132259-10-0',
    molecularWeight: 28.96,
    C1: 2.8963,
    C2: 0.26733,
    C3: 132.45,
    C4: 0.27341,
    minimumTemperature: 59.15,
    maximumTemperature: 132.45,
    densityAtMinimumTemperature: 33.279,
    densityAtMaximumTemperature: 10.834,
  },

  Ammonia: {
    name: 'Ammonia',
    formula: 'H3N',
    CAS: '7664-41-7',
    molecularWeight: 17.03052,
    C1: 3.5383,
    C2: 0.25443,
    C3: 405.65,
    C4: 0.2888,
    minimumTemperature: 195.41,
    maximumTemperature: 405.65,
    densityAtMinimumTemperature: 43.141,
    densityAtMaximumTemperature: 13.907,
  },

  Anisole: {
    name: 'Anisole',
    formula: 'C7H8O',
    CAS: '100-66-3',
    molecularWeight: 108.13782,
    C1: 0.77488,
    C2: 0.26114,
    C3: 645.6,
    C4: 0.28234,
    minimumTemperature: 235.65,
    maximumTemperature: 645.6,
    densityAtMinimumTemperature: 9.6675,
    densityAtMaximumTemperature: 2.9673,
  },

  Argon: {
    name: 'Argon',
    formula: 'Ar',
    CAS: '7440-37-1',
    molecularWeight: 39.948,
    C1: 3.8469,
    C2: 0.2881,
    C3: 150.86,
    C4: 0.29783,
    minimumTemperature: 83.78,
    maximumTemperature: 150.86,
    densityAtMinimumTemperature: 35.491,
    densityAtMaximumTemperature: 13.353,
  },

  Benzamide: {
    name: 'Benzamide',
    formula: 'C7H7NO',
    CAS: '55-21-0',
    molecularWeight: 121.13658,
    C1: 0.7371,
    C2: 0.25487,
    C3: 824,
    C4: 0.28571,
    minimumTemperature: 403.0,
    maximumTemperature: 824.0,
    densityAtMinimumTemperature: 8.9381,
    densityAtMaximumTemperature: 2.8921,
  },
  //Batch 1---->

  //<----Batch 2

  Benzene: {
    name: 'Benzene',
    formula: 'C6H6',
    CAS: '71-43-2',
    molecularWeight: 78.11184,
    C1: 1.0259,
    C2: 0.26666,
    C3: 562.05,
    C4: 0.28394,
    minimumTemperature: 278.68,
    maximumTemperature: 562.05,
    densityAtMinimumTemperature: 11.422,
    densityAtMaximumTemperature: 3.8472,
  },

  Benzenethiol: {
    name: 'Benzenethiol',
    formula: 'C6H6S',
    CAS: '108-98-5',
    molecularWeight: 110.17684,
    C1: 0.83573,
    C2: 0.26326,
    C3: 689,
    C4: 0.30798,
    minimumTemperature: 258.27,
    maximumTemperature: 689,
    densityAtMinimumTemperature: 10.074,
    densityAtMaximumTemperature: 3.1745,
  },

  BenzoicAcid: {
    name: 'Benzoic acid',
    formula: 'C7H6O2',
    CAS: '65-85-0',
    molecularWeight: 122.12134,
    C1: 0.71587,
    C2: 0.24812,
    C3: 751,
    C4: 0.2857,
    minimumTemperature: 395.45,
    maximumTemperature: 751,
    densityAtMinimumTemperature: 8.8935,
    densityAtMaximumTemperature: 2.8852,
  },

  Benzonitrile: {
    name: 'Benzonitrile',
    formula: 'C7H5N',
    CAS: '100-47-0',
    molecularWeight: 103.1213,
    C1: 0.72184,
    C2: 0.24606,
    C3: 702.3,
    C4: 0.28789,
    minimumTemperature: 260.28,
    maximumTemperature: 702.3,
    densityAtMinimumTemperature: 10.008,
    densityAtMaximumTemperature: 2.9336,
  },

  Benzophenone: {
    name: 'Benzophenone',
    formula: 'C13H10O',
    CAS: '119-61-9',
    molecularWeight: 182.2179,
    C1: 0.43743,
    C2: 0.24833,
    C3: 830,
    C4: 0.27555,
    minimumTemperature: 321.35,
    maximumTemperature: 830,
    densityAtMinimumTemperature: 5.9496,
    densityAtMaximumTemperature: 1.7615,
  },

  BenzylAlcohol: {
    name: 'Benzyl alcohol',
    formula: 'C7H8O',
    CAS: '100-51-6',
    molecularWeight: 108.13782,
    C1: 0.59867,
    C2: 0.22849,
    C3: 720.15,
    C4: 0.23567,
    minimumTemperature: 257.85,
    maximumTemperature: 720.15,
    densityAtMinimumTemperature: 9.9051,
    densityAtMaximumTemperature: 2.6201,
  },

  BenzylEthylEther: {
    name: 'Benzyl ethyl ether',
    formula: 'C9H12O',
    CAS: '539-30-0',
    molecularWeight: 136.19098,
    C1: 0.60917,
    C2: 0.26925,
    C3: 662,
    C4: 0.2632,
    minimumTemperature: 275.65,
    maximumTemperature: 662,
    densityAtMinimumTemperature: 7.0651,
    densityAtMaximumTemperature: 2.2625,
  },

  BenzylMercaptan: {
    name: 'Benzyl mercaptan',
    formula: 'C7H8S',
    CAS: '100-53-8',
    molecularWeight: 124.20342,
    C1: 0.70797,
    C2: 0.25982,
    C3: 718,
    C4: 0.32144,
    minimumTemperature: 243.95,
    maximumTemperature: 718,
    densityAtMinimumTemperature: 8.8623,
    densityAtMaximumTemperature: 2.7248,
  },

  Biphenyl: {
    name: 'Biphenyl',
    formula: 'C12H10',
    CAS: '92-52-4',
    molecularWeight: 154.2078,
    C1: 0.52257,
    C2: 0.25833,
    C3: 773,
    C4: 0.27026,
    minimumTemperature: 342.2,
    maximumTemperature: 773,
    densityAtMinimumTemperature: 6.4251,
    densityAtMaximumTemperature: 2.0229,
  },

  Bromine: {
    name: 'Bromine',
    formula: 'Br2',
    CAS: '7726-95-6',
    molecularWeight: 159.808,
    C1: 2.1872,
    C2: 0.29527,
    C3: 584.15,
    C4: 0.3295,
    minimumTemperature: 265.85,
    maximumTemperature: 584.15,
    densityAtMinimumTemperature: 20.109,
    densityAtMaximumTemperature: 7.4075,
  },

  Bromobenzene: {
    name: 'Bromobenzene',
    formula: 'C6H5Br',
    CAS: '108-86-1',
    molecularWeight: 157.0079,
    C1: 0.8226,
    C2: 0.26632,
    C3: 670.15,
    C4: 0.2821,
    minimumTemperature: 242.43,
    maximumTemperature: 670.15,
    densityAtMinimumTemperature: 9.9087,
    densityAtMaximumTemperature: 3.0888,
  },

  Bromoethane: {
    name: 'Bromoethane',
    formula: 'C2H5Br',
    CAS: '74-96-4',
    molecularWeight: 108.965,
    C1: 1.3285,
    C2: 0.2708,
    C3: 503.8,
    C4: 0.3012,
    minimumTemperature: 154.25,
    maximumTemperature: 503.8,
    densityAtMinimumTemperature: 15.809,
    densityAtMaximumTemperature: 4.9058,
  },

  Bromomethane: {
    name: 'Bromomethane',
    formula: 'CH3Br',
    CAS: '74-83-9',
    molecularWeight: 94.93852,
    C1: 1.796,
    C2: 0.27065,
    C3: 464,
    C4: 0.28947,
    minimumTemperature: 173,
    maximumTemperature: 464,
    densityAtMinimumTemperature: 20.787,
    densityAtMaximumTemperature: 6.6359,
  },

  '1,2Butadiene': {
    name: '1,2-Butadiene',
    formula: 'C4H6',
    CAS: '590-19-2',
    molecularWeight: 54.09044,
    C1: 1.187,
    C2: 0.26114,
    C3: 452,
    C4: 0.3065,
    minimumTemperature: 136.95,
    maximumTemperature: 452,
    densityAtMinimumTemperature: 15.123,
    densityAtMaximumTemperature: 4.5455,
  },

  '1,3Butadiene': {
    name: '1,3-Butadiene',
    formula: 'C4H6',
    CAS: '106-99-0',
    molecularWeight: 54.09044,
    C1: 1.2346,
    C2: 0.27216,
    C3: 425,
    C4: 0.28707,
    minimumTemperature: 164.25,
    maximumTemperature: 425,
    densityAtMinimumTemperature: 14.058,
    densityAtMaximumTemperature: 4.5363,
  },

  Butane: {
    name: 'Butane',
    formula: 'C4H10',
    CAS: '106-97-8',
    molecularWeight: 58.1222,
    C1: 1.0677,
    C2: 0.27188,
    C3: 425.12,
    C4: 0.28688,
    minimumTemperature: 134.86,
    maximumTemperature: 425.12,
    densityAtMinimumTemperature: 12.62,
    densityAtMaximumTemperature: 3.9271,
  },

  '1,2Butanediol': {
    name: '1,2-Butanediol',
    formula: 'C4H10O2',
    CAS: '584-03-2',
    molecularWeight: 90.121,
    C1: 0.81696,
    C2: 0.24755,
    C3: 680,
    C4: 0.24535,
    minimumTemperature: 220,
    maximumTemperature: 680,
    densityAtMinimumTemperature: 11.734,
    densityAtMaximumTemperature: 3.3002,
  },

  '1,3Butanediol': {
    name: '1,3-Butanediol',
    formula: 'C4H10O2',
    CAS: '107-88-0',
    molecularWeight: 90.121,
    C1: 0.81856,
    C2: 0.24967,
    C3: 676,
    C4: 0.22023,
    minimumTemperature: 196.15,
    maximumTemperature: 676,
    densityAtMinimumTemperature: 11.872,
    densityAtMaximumTemperature: 3.2786,
  },

  //Batch 2---->
  oTerphenyl: {
    name: 'o-Terphenyl',
    formula: 'C18H14',
    CAS: '84-15-1',
    molecularWeight: 230.30376,
    C1: 5.7136,
    C2: -0.003474,
    C3: NaN,
    C4: NaN,
    minimumTemperature: 288.15,
    maximumTemperature: 313.19,
    densityAtMinimumTemperature: 4.7126,
    densityAtMaximumTemperature: 4.6256,
  },
  oTerphenylExtended: {
    name: 'o-Terphenyl',
    formula: 'C18H14',
    CAS: '84-15-1',
    molecularWeight: 230.30376,
    C1: 0.3448,
    C2: 0.25116,
    C3: 857,
    C4: 0.29268,
    minimumTemperature: 329.35,
    maximumTemperature: 857.0,
    densityAtMinimumTemperature: 4.5526,
    densityAtMaximumTemperature: 1.3728,
  },
  Water: {
    name: 'Water',
    formula: 'H2O',
    CAS: '7732-18-5',
    molecularWeight: 18.01528,
    C1: -13.851,
    C2: 0.64038,
    C3: -0.0019124,
    C4: 1.8211e-6,
    minimumTemperature: 273.16,
    maximumTemperature: 353.15,
    densityAtMinimumTemperature: 55.497,
    densityAtMaximumTemperature: 54.001,
  },
  WaterExtended: {
    name: 'Water',
    formula: 'H2O',
    CAS: '7732-18-5',
    molecularWeight: 18.01528,
    C1: 17.874,
    C2: 35.618,
    C3: 19.655,
    C4: -9.1306,
    C5: -31.367,
    C6: -813.56,
    C7: -17421000,
    minimumTemperature: 273.16,
    maximumTemperature: 647.096,
    densityAtMinimumTemperature: 55.487,
    densityAtMaximumTemperature: 17.874,
  },
};

function calculateDIPPRDensityForOTerphenyl(temperature: number): number {
  const densityProps = DIPPRDensityDictionary['oTerphenyl'];
  const densityPropsExtended = DIPPRDensityDictionary['oTerphenylExtended'];
  let density = NaN;
  if (
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    density = densityProps.C1 + densityProps.C2 * temperature;
  } else if (
    temperature >= densityPropsExtended.minimumTemperature &&
    temperature <= densityPropsExtended.maximumTemperature
  ) {
    const exponent =
      1 +
      Math.pow(
        1 - temperature / densityPropsExtended.C3,
        densityPropsExtended.C4
      );
    density =
      densityPropsExtended.C1 / Math.pow(densityPropsExtended.C2, exponent);
  }
  return density;
}

function calculateDIPPRDensityForWater(temperature: number): number {
  const densityProps = DIPPRDensityDictionary['Water'];
  const densityPropsExtended = DIPPRDensityDictionary['WaterExtended'];
  let density = NaN;
  if (
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    density =
      densityProps.C1 +
      densityProps.C2 * temperature +
      densityProps.C3 * Math.pow(temperature, 2) +
      densityProps.C4 * Math.pow(temperature, 3);
  } else if (
    temperature >= densityPropsExtended.minimumTemperature &&
    temperature < densityPropsExtended.maximumTemperature
  ) {
    const criticalTemperature = 647.096;
    const tau = 1 - temperature / criticalTemperature;
    density =
      densityProps.C1 +
      densityProps.C2 * Math.pow(tau, 1 / 3) +
      densityProps.C3 * Math.pow(tau, 2 / 3) +
      densityProps.C4 * Math.pow(tau, 5 / 3) +
      (densityProps.C5 as number) * Math.pow(tau, 16 / 3) +
      (densityProps.C6 as number) * Math.pow(tau, 43 / 3) +
      (densityProps.C7 as number) * Math.pow(tau, 110 / 3);
  } else if (
    Math.abs(temperature - densityPropsExtended.maximumTemperature) < 1e-4
  ) {
    density = densityPropsExtended.densityAtMaximumTemperature;
  }
  return density;
}

export function calculateDIPPRDensity(
  compound: string,
  temperature: number
): number {
  const densityProps: DIPPRDensityProps | undefined =
    DIPPRDensityDictionary[compound];
  let density = NaN;
  if (compound === 'Water') {
    density = calculateDIPPRDensityForWater(temperature);
  } else if (compound === 'oTerphenyl') {
    density = calculateDIPPRDensityForOTerphenyl(temperature);
  } else if (
    densityProps !== undefined &&
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    const exponent =
      1 + Math.pow(1 - temperature / densityProps.C3, densityProps.C4);
    density = densityProps.C1 / Math.pow(densityProps.C2, exponent);
  }
  return density;
}
