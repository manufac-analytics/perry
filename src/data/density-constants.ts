import { DIPPRDensityProps } from '../interfaces/utils';

export const DIPPRDensityDictionary: Record<string, DIPPRDensityProps> = {
  Acetaldehyde: {
    name: 'Acetaldehyde',
    formula: 'C2H4O',
    CAS: '75-07-0',
    molecularWeight: 44.05256,
    C1: 1.711365,
    C2: 0.26355,
    C3: 466,
    C4: 0.28571,
    minimumTemperature: 149.78,
    maximumTemperature: 466,
    densityAtMinimumTemperature: 21.423,
    densityAtMaximumTemperature: 6.4935,
  },
  //<----Batch1
  Acetamide: {
    name: 'Acetamide',
    formula: 'C2H5NO',
    CAS: '60-35-5',
    molecularWeight: 59.0672,
    C1: 1.016,
    C2: 0.21845,
    C3: 761,
    C4: 0.26116,
    minimumTemperature: 353.33,
    maximumTemperature: 761.0,
    densityAtMinimumTemperature: 16.936,
    densityAtMaximumTemperature: 4.6509,
  },

  AceticAcid: {
    name: 'Acetic acid',
    formula: 'C2H4O2',
    CAS: '64-19-7',
    molecularWeight: 60.052,
    C1: 1.4486,
    C2: 0.25892,
    C3: 591.95,
    C4: 0.2529,
    minimumTemperature: 289.81,
    maximumTemperature: 591.95,
    densityAtMinimumTemperature: 17.492,
    densityAtMaximumTemperature: 5.5948,
  },

  AceticAnhydride: {
    name: 'Acetic anhydride',
    formula: 'C4H6O3',
    CAS: '108-24-7',
    molecularWeight: 102.08864,
    C1: 0.79388,
    C2: 0.24119,
    C3: 606,
    C4: 0.29817,
    minimumTemperature: 200.15,
    maximumTemperature: 606.0,
    densityAtMinimumTemperature: 11.626,
    densityAtMaximumTemperature: 3.2915,
  },

  Acetone: {
    name: 'Acetone',
    formula: 'C3H6O',
    CAS: '67-64-1',
    molecularWeight: 58.07914,
    C1: 1.2332,
    C2: 0.25886,
    C3: 508.2,
    C4: 0.2913,
    minimumTemperature: 178.45,
    maximumTemperature: 508.2,
    densityAtMinimumTemperature: 15.683,
    densityAtMaximumTemperature: 4.764,
  },

  Acetonitrile: {
    name: 'Acetonitrile',
    formula: 'C2H3N',
    CAS: '75-05-8',
    molecularWeight: 41.0519,
    C1: 1.0693,
    C2: 0.20656,
    C3: 545.5,
    C4: 0.24699,
    minimumTemperature: 229.32,
    maximumTemperature: 545.5,
    densityAtMinimumTemperature: 20.544,
    densityAtMaximumTemperature: 5.1767,
  },

  Acetylene: {
    name: 'Acetylene',
    formula: 'C2H2',
    CAS: '74-86-2',
    molecularWeight: 26.03728,
    C1: 2.4507,
    C2: 0.27448,
    C3: 308.3,
    C4: 0.28752,
    minimumTemperature: 192.4,
    maximumTemperature: 308.3,
    densityAtMinimumTemperature: 23.692,
    densityAtMaximumTemperature: 8.9285,
  },

  Acrolein: {
    name: 'Acrolein',
    formula: 'C3H4O',
    CAS: '107-02-8',
    molecularWeight: 56.06326,
    C1: 1.3261,
    C2: 0.26124,
    C3: 506,
    C4: 0.2489,
    minimumTemperature: 185.45,
    maximumTemperature: 506.0,
    densityAtMinimumTemperature: 16.822,
    densityAtMaximumTemperature: 5.0762,
  },

  AcrylicAcid: {
    name: 'Acrylic acid',
    formula: 'C3H4O2',
    CAS: '79-10-7',
    molecularWeight: 72.06266,
    C1: 1.2414,
    C2: 0.25822,
    C3: 615,
    C4: 0.30701,
    minimumTemperature: 286.15,
    maximumTemperature: 615,
    densityAtMinimumTemperature: 14.693,
    densityAtMaximumTemperature: 4.8075,
  },

  Acrylonitrile: {
    name: 'Acrylonitrile',
    formula: 'C3H3N',
    CAS: '107-13-1',
    molecularWeight: 53.0626,
    C1: 1.0379,
    C2: 0.22465,
    C3: 540,
    C4: 0.28921,
    minimumTemperature: 189.63,
    maximumTemperature: 540,
    densityAtMinimumTemperature: 17.254,
    densityAtMaximumTemperature: 4.6201,
  },

  Air: {
    name: 'Air',
    formula: 'Mixture',
    CAS: '132259-10-0',
    molecularWeight: 28.96,
    C1: 2.8963,
    C2: 0.26733,
    C3: 132.45,
    C4: 0.27341,
    minimumTemperature: 59.15,
    maximumTemperature: 132.45,
    densityAtMinimumTemperature: 33.279,
    densityAtMaximumTemperature: 10.834,
  },

  Ammonia: {
    name: 'Ammonia',
    formula: 'H3N',
    CAS: '7664-41-7',
    molecularWeight: 17.03052,
    C1: 3.5383,
    C2: 0.25443,
    C3: 405.65,
    C4: 0.2888,
    minimumTemperature: 195.41,
    maximumTemperature: 405.65,
    densityAtMinimumTemperature: 43.141,
    densityAtMaximumTemperature: 13.907,
  },

  Anisole: {
    name: 'Anisole',
    formula: 'C7H8O',
    CAS: '100-66-3',
    molecularWeight: 108.13782,
    C1: 0.77488,
    C2: 0.26114,
    C3: 645.6,
    C4: 0.28234,
    minimumTemperature: 235.65,
    maximumTemperature: 645.6,
    densityAtMinimumTemperature: 9.6675,
    densityAtMaximumTemperature: 2.9673,
  },

  Argon: {
    name: 'Argon',
    formula: 'Ar',
    CAS: '7440-37-1',
    molecularWeight: 39.948,
    C1: 3.8469,
    C2: 0.2881,
    C3: 150.86,
    C4: 0.29783,
    minimumTemperature: 83.78,
    maximumTemperature: 150.86,
    densityAtMinimumTemperature: 35.491,
    densityAtMaximumTemperature: 13.353,
  },

  Benzamide: {
    name: 'Benzamide',
    formula: 'C7H7NO',
    CAS: '55-21-0',
    molecularWeight: 121.13658,
    C1: 0.7371,
    C2: 0.25487,
    C3: 824,
    C4: 0.28571,
    minimumTemperature: 403.0,
    maximumTemperature: 824.0,
    densityAtMinimumTemperature: 8.9381,
    densityAtMaximumTemperature: 2.8921,
  },
  //Batch 1---->
  oTerphenyl: {
    name: 'o-Terphenyl',
    formula: 'C18H14',
    CAS: '84-15-1',
    molecularWeight: 230.30376,
    C1: 5.7136,
    C2: -0.003474,
    C3: NaN,
    C4: NaN,
    minimumTemperature: 288.15,
    maximumTemperature: 313.19,
    densityAtMinimumTemperature: 4.7126,
    densityAtMaximumTemperature: 4.6256,
  },
  oTerphenylExtended: {
    name: 'o-Terphenyl',
    formula: 'C18H14',
    CAS: '84-15-1',
    molecularWeight: 230.30376,
    C1: 0.3448,
    C2: 0.25116,
    C3: 857,
    C4: 0.29268,
    minimumTemperature: 329.35,
    maximumTemperature: 857.0,
    densityAtMinimumTemperature: 4.5526,
    densityAtMaximumTemperature: 1.3728,
  },
  Water: {
    name: 'Water',
    formula: 'H2O',
    CAS: '7732-18-5',
    molecularWeight: 18.01528,
    C1: -13.851,
    C2: 0.64038,
    C3: -0.0019124,
    C4: 1.8211e-6,
    minimumTemperature: 273.16,
    maximumTemperature: 353.15,
    densityAtMinimumTemperature: 55.497,
    densityAtMaximumTemperature: 54.001,
  },
  WaterExtended: {
    name: 'Water',
    formula: 'H2O',
    CAS: '7732-18-5',
    molecularWeight: 18.01528,
    C1: 17.874,
    C2: 35.618,
    C3: 19.655,
    C4: -9.1306,
    C5: -31.367,
    C6: -813.56,
    C7: -17421000,
    minimumTemperature: 273.16,
    maximumTemperature: 647.096,
    densityAtMinimumTemperature: 55.487,
    densityAtMaximumTemperature: 17.874,
  },
};

function calculateDIPPRDensityForOTerphenyl(temperature: number): number {
  const densityProps = DIPPRDensityDictionary['oTerphenyl'];
  const densityPropsExtended = DIPPRDensityDictionary['oTerphenylExtended'];
  let density = NaN;
  if (
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    density = densityProps.C1 + densityProps.C2 * temperature;
  } else if (
    temperature >= densityPropsExtended.minimumTemperature &&
    temperature <= densityPropsExtended.maximumTemperature
  ) {
    const exponent =
      1 +
      Math.pow(
        1 - temperature / densityPropsExtended.C3,
        densityPropsExtended.C4
      );
    density =
      densityPropsExtended.C1 / Math.pow(densityPropsExtended.C2, exponent);
  }
  return density;
}

function calculateDIPPRDensityForWater(temperature: number): number {
  const densityProps = DIPPRDensityDictionary['Water'];
  const densityPropsExtended = DIPPRDensityDictionary['WaterExtended'];
  let density = NaN;
  if (
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    density =
      densityProps.C1 +
      densityProps.C2 * temperature +
      densityProps.C3 * Math.pow(temperature, 2) +
      densityProps.C4 * Math.pow(temperature, 3);
  } else if (
    temperature >= densityPropsExtended.minimumTemperature &&
    temperature < densityPropsExtended.maximumTemperature
  ) {
    const criticalTemperature = 647.096;
    const tau = 1 - temperature / criticalTemperature;
    density =
      densityProps.C1 +
      densityProps.C2 * Math.pow(tau, 1 / 3) +
      densityProps.C3 * Math.pow(tau, 2 / 3) +
      densityProps.C4 * Math.pow(tau, 5 / 3) +
      (densityProps.C5 as number) * Math.pow(tau, 16 / 3) +
      (densityProps.C6 as number) * Math.pow(tau, 43 / 3) +
      (densityProps.C7 as number) * Math.pow(tau, 110 / 3);
  } else if (
    Math.abs(temperature - densityPropsExtended.maximumTemperature) < 1e-4
  ) {
    density = densityPropsExtended.densityAtMaximumTemperature;
  }
  return density;
}

export function calculateDIPPRDensity(
  compound: string,
  temperature: number
): number {
  const densityProps: DIPPRDensityProps | undefined =
    DIPPRDensityDictionary[compound];
  let density = NaN;
  if (compound === 'Water') {
    density = calculateDIPPRDensityForWater(temperature);
  } else if (compound === 'oTerphenyl') {
    density = calculateDIPPRDensityForOTerphenyl(temperature);
  } else if (
    densityProps !== undefined &&
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    const exponent =
      1 + Math.pow(1 - temperature / densityProps.C3, densityProps.C4);
    density = densityProps.C1 / Math.pow(densityProps.C2, exponent);
  }
  return density;
}
